<!DOCTYPE html>
<html>
    <head>
        <title>Window Test</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="../../../jquery-3.1.1.js"></script>
        <script src="../obj.js"></script>
        <script src="../util.js"></script>
        <script src="../unitTest.js"></script>
        <script src="../testData.js"></script>

    </head>
    <body>
        <h1>This is a window JS Test</h1>
        <button name="b1" id="show">Refresh!</button>
        <p></p>
        <div id="demo"></div>
        <script></script>
        <script>
            var alltests = function () {
                try {
                    var ut = TestCase.getInstance();
                    var i, j, temp, d;
                    {
                        // Test(1) - Start
                        ut.startMark("1", "window<br>");
                        ut.setIndex();
                        ut.writeLog("For IE11");
                        ut.writeLog("Window.prototype.__proto__ === Object.prototype");
                        if (Window.prototype.__proto__ === Object.prototype) {
                            ut.assertTrue(Window.prototype.__proto__ === Object.prototype);
                        }
                        ut.writeLog("For FIrefox & Chrome");
                        ut.writeLog("Window.prototype.__proto__.__proto__.__proto__ === Object.prototype");
                        if (Window.prototype.__proto__ !== Object.prototype) {
                            ut.assertTrue(Window.prototype.__proto__.__proto__.__proto__ === Object.prototype);
                        }
                        //ut.writeLog("---------------------------------------------------------------<br>");
                        ut.writeLog(" ");
                        ut.writeLog("window instanceof Window");
                        ut.assertTrue(window instanceof Window);
                        ut.writeLog("Window.prototype.isPrototypeOf(window)");
                        ut.assertTrue(Window.prototype.isPrototypeOf(window));
                        ut.writeLog(" ");

                        let pn = Object.getOwnPropertyNames(window);
                        let kn = Object.keys(window);
                        let pn2 = Object.getOwnPropertyNames(Window.prototype);

                        ut.writeLog("@Object.getOwnPropertyNames(window) & ");
                        ut.writeLog("@!Object.prototype.propertyIsEnumerable.call(window, pn[i])");
                        temp = [];
                        for (i = 0; i < pn.length; i++) {
                            if (!Object.prototype.propertyIsEnumerable.call(window, pn[i])) {
                                temp.push(pn[i]);
                                if ((temp.length) % 7 === 0) {
                                    ut.writeLog(temp.join(" , "));
                                    temp = [];
                                }
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            temp.push(kn[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+a");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@d.configurable: false");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (!d.configurable) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+b");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@d.configurable: true");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (d.configurable) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+c");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@d.writable: false");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (!d.writable) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+d");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@d.writable: true");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (d.writable) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+e");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@d.configurable: false, d.writable: true");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (!d.configurable && d.writable) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+f");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@!(d.configurable: false, d.writable: true)");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (window[kn[i]]) {
                                d = Object.getOwnPropertyDescriptor(window, kn[i]);
                                if (!(!d.configurable && d.writable)) {
                                    temp.push(kn[i]);
                                    if ((temp.length) % 7 === 0) {
                                        ut.writeLog(temp.join(" , "));
                                        temp = [];
                                    }
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.writeLog("@Object.keys(window)+g");
                        ut.writeLog("@Object.getOwnPropertyDescriptor(window, prop)");
                        ut.writeLog("@(!window[kn[i]])");
                        temp = [];
                        for (i = 0; i < kn.length; i++) {
                            if (!window[kn[i]]) {
                                temp.push(kn[i]);
                                if ((temp.length) % 7 === 0) {
                                    ut.writeLog(temp.join(" , ") + "   <<<");
                                    temp = [];
                                }
                            }

                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@Object.getOwnPropertyNames(Window): ");
                        ut.writeLog("pn.length: " + pn.length);
                        ut.writeLog(" ");
                        ut.writeLog("@Object.getOwnPropertyNames(Window.prototype): ");
                        ut.writeLog("pn2.length: " + pn2.length);
                        temp = [];
                        for (i = 0; i < pn2.length; i++) {
                            temp.push(pn2[i]);
                            if ((temp.length) % 5 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        if (Window.prototype.__proto__ !== Object.prototype) {
                            let pn3 = Object.getOwnPropertyNames(Window.prototype.__proto__);
                            let pn4 = Object.getOwnPropertyNames(Window.prototype.__proto__.__proto__);
                            ut.writeLog("@Object.getOwnPropertyNames(Window.prototype.__proto__): ");
                            ut.writeLog("pn3.length: " + pn3.length);
                            temp = [];
                            for (i = 0; i < pn3.length; i++) {
                                temp.push(pn3[i]);
                                if ((temp.length) % 7 === 0) {
                                    ut.writeLog(temp.join(" , "));
                                    temp = [];
                                }
                            }
                            if (temp.length > 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                            ut.writeLog(" ");

                            ut.writeLog("@Object.getOwnPropertyNames(Window.prototype.__proto__.__proto__): ");
                            ut.writeLog("pn4.length: " + pn4.length);
                            temp = [];
                            for (i = 0; i < pn4.length; i++) {
                                temp.push(pn4[i]);
                                if ((temp.length) % 7 === 0) {
                                    ut.writeLog(temp.join(" , "));
                                    temp = [];
                                }
                            }
                            if (temp.length > 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                            ut.writeLog(" ");

                            if ("chrome" in window) {
                                ut.writeLog("For Chrome Browser: ");
                                ut.writeLog("chrome: " + typeof window.chrome);
                                ut.writeLog("location: " + typeof window.location);
                                ut.writeLog(" ");
                            }


                            //ut.assertTrue(Window.prototype.__proto__.__proto__.__proto__ === Object.prototype);
                        }


                        ut.writeLog(window.document.toString());
                        ut.writeLog({}.toString());
                        ut.writeLog("typeof Array； " + typeof Array);
                        ut.writeLog("typeof Object； " + typeof Object);
                        ut.writeLog("typeof Date； " + typeof Date);
                        ut.writeLog("Date in window； " + Date in window);

                        let des = Object.getOwnPropertyDescriptor(Window.prototype, "document");
                        console.log(Window.prototype);
                        console.log(pn.indexOf("document") + " - " + pn.length);
                        console.log(pn2.indexOf("document") + " - " + pn2.length);


                        ut.writeLog(" ");
                        ut.endMark("1", "window");
                        // Test(1) - end
                    }

                    {
                        // Test(2) - Start
                        ut.startMark("2", "<br>");
                        ut.setIndex();
                        var bio = [], pn = [], custom = [], others = [];
                        var i, isEnumerable, d, enu;
                        isEnumerable = Object.prototype.propertyIsEnumerable;
                        // get all the globe objects
                        for (i = this; i !== Object.prototype && i; i = getProto(i)) {
                            pn = pn.concat(Object.getOwnPropertyNames(i));
                            console.info("pn: ", pn.length);
                        }
                        // get the built-in globe objects.
                        for (i = 0; i < pn.length; i++) {
                            if ((typeof this[pn[i]] === 'object' ||
                                    typeof this[pn[i]] === 'function') && this[pn[i]] !== null) {
                                d = Object.getOwnPropertyDescriptor(this, pn[i]);
                                enu = isEnumerable.call(this, pn[i]); // d.enumerable
                                if ((!enu || (enu && !(!d.configurable && d.writable)))) {
                                    bio.push(pn[i]);
                                } else
                                    custom.push(pn[i]);
                            } else
                                others.push(pn[i]);
                        }

                        ut.writeLog("@BiO: ");
                        ut.writeLog("@BiO.length / pn.length: " + bio.length + "/" + pn.length);
                        temp = [];
                        for (i = 0; i < bio.length; i++) {
                            temp.push(bio[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@Custom: ");
                        ut.writeLog("@custom.length: " + custom.length);
                        temp = [];
                        for (i = 0; i < custom.length; i++) {
                            temp.push(custom[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@Others: ");
                        ut.writeLog("@others.length: " + others.length);
                        temp = [];
                        for (i = 0; i < others.length; i++) {
                            temp.push(others[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@Others Type: ");
                        temp = [];
                        for (i = 0; i < others.length; i++) {
                            temp.push(type(window[others[i]]));
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");
                        ut.writeLog('pn.indexOf("Date"): ' + pn.indexOf("Date"));
                        ut.writeLog('bio.indexOf("Date"): ' + bio.indexOf("Date"));
                        ut.writeLog('typeof /[a-z]/i :  ' + typeof /[a-z]/i);


                        ut.writeLog(" ");
                        ut.endMark("2", "");
                        // Test(2) - end
                    }

                    {
                        // Test(3) - Start
                        ut.startMark("3", "");
                        ut.setIndex();
                        var upbio = [], downbio = [], tfupbio = [],
                                upbiof = [], upbioclass = [], upbioclassp = [];
                        var isUp = function (str) {
                            if (typeof str === 'string') {
                                return /^[A-Z][a-zA-Z0-9_$]*$/.test(str);
                            }
                            return false;
                        };
                        ut.writeLog('isUp("String") : ' + isUp("String"));
                        ut.writeLog('isUp("string") : ' + isUp("string"));
                        ut.writeLog('isUp("STring") : ' + isUp("STring"));
                        ut.writeLog('isUp("STrinGs") : ' + isUp("STrinGs"));
                        ut.writeLog('isUp("sTrinG") : ' + isUp("sTrinG"));
                        ut.writeLog(" ");

                        for (i = 0; i < bio.length; i++) {
                            if (isUp(bio[i])) {
                                upbio.push(bio[i]);
                                upbioclass.push(Object.prototype.toString.call(window[bio[i]]));
                                upbioclassp.push(Object.prototype.toString.call(window[bio[i]].prototype));
                                tfupbio.push(typeof window[bio[i]]);
                                if (typeof window[bio[i]] === 'function')
                                    upbiof.push(bio[i]);
                            } else
                                downbio.push(bio[i]);
                        }


                        ut.writeLog("@upBiO: ");
                        ut.writeLog("@upbio.length / bio.length: " + upbio.length + "/" + bio.length);
                        temp = [];
                        for (i = 0; i < upbio.length; i++) {
                            temp.push(upbio[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@downBiO: ");
                        ut.writeLog("@downbio.length / bio.length: " + downbio.length + "/" + bio.length);
                        temp = [];
                        for (i = 0; i < downbio.length; i++) {
                            temp.push(downbio[i]);
                            if ((temp.length) % 7 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@BiO Class: ");
                        ut.writeLog("@upbioclass.length / upbio.length: " + upbioclass.length + "/" + upbio.length);
                        temp = [];
                        for (i = 0; i < upbioclass.length; i++) {
                            temp.push(upbioclass[i]);
                            if ((temp.length) % 5 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@BiO Prototype Class: ");
                        ut.writeLog("@upbioclassp.length / upbio.length: " + upbioclassp.length + "/" + upbio.length);
                        temp = [];
                        for (i = 0; i < upbioclassp.length; i++) {
                            temp.push(upbioclassp[i]);
                            if ((temp.length) % 5 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog("@Typeof BiO: ");
                        ut.writeLog("@tfupbio.length / upbio.length: " + tfupbio.length + "/" + upbio.length);
                        temp = [];
                        for (i = 0; i < tfupbio.length; i++) {
                            temp.push(tfupbio[i]);
                            if ((temp.length) % 5 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");
                        
                        ut.writeLog("@Function BiO: ");
                        ut.writeLog("@upbiof.length / upbio.length: " + upbiof.length + "/" + upbio.length);
                        temp = [];
                        for (i = 0; i < upbiof.length; i++) {
                            temp.push(upbiof[i]);
                            if ((temp.length) % 5 === 0) {
                                ut.writeLog(temp.join(" , "));
                                temp = [];
                            }
                        }
                        if (temp.length > 0) {
                            ut.writeLog(temp.join(" , "));
                            temp = [];
                        }
                        ut.writeLog(" ");

                        ut.writeLog(" ");
                        ut.endMark("3", "");
                        // Test(3) - end
                    }

                    grab("demo").innerHTML = ut.conclude();
                } catch (err) {
                    alert(err.name + ": " + err.message);
                }
            }.bind(this);
            alltests();
            $(document).ready(function () {
                try {
                    txt = "Hello, World!";
                    $("#show").on("click", alltests);
                } catch (err) {
                    alert(err.name + ": " + err.message);
                }
            });
        </script>

    </body>
</html>
